#!/bin/bash

# Function to check if directory exists
check_directory() {
    local dir_path=$1
    if [ ! -d "$dir_path" ]; then
        echo "Error: Directory '$dir_path' does not exist"
        exit 1
    fi
}

# Function to validate files and folders
validate_items() {
    local dir_path=$1
    local total_items=0
    local error_count=0

    echo "Starting validation of directory: $dir_path"
    echo "----------------------------------------"

    # Loop through all items in directory
    for item in "$dir_path"/*; do
        ((total_items++))
        echo "Checking: $item"
        
        # Check if item exists
        if [ ! -e "$item" ]; then
            echo "ERROR: $item does not exist"
            ((error_count++))
            continue
        fi

        # Check permissions
        if [ ! -r "$item" ]; then
            echo "ERROR: $item is not readable"
            ((error_count++))
        fi

        # Directory specific checks
        if [ -d "$item" ]; then
            if [ ! -x "$item" ]; then
                echo "ERROR: Directory $item is not traversable"
                ((error_count++))
            fi
        fi

        # File specific checks
        if [ -f "$item" ]; then
            if [ ! -s "$item" ]; then
                echo "WARNING: $item is empty"
            fi
        fi
    done

    # Print summary
    echo "----------------------------------------"
    echo "Validation Results:"
    echo "Total items checked: $total_items"
    echo "Items with errors: $error_count"
    
    return $error_count
}

# Main function
main() {
    if [ $# -eq 0 ]; then
        echo "Usage: $0 <directory_path>"
        exit 1
    fi

    local dir_path=$1
    
    # Check if directory exists
    check_directory "$dir_path"
    
    # Validate items in directory
    validate_items "$dir_path"
    local status=$?

    if [ $status -eq 0 ]; then
        echo "Status: PASSED"
        exit 0
    else
        echo "Status: FAILED"
        exit 1
    fi
}

# Call main function with all arguments passed to script
main "$@"
